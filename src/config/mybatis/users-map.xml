<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="usersNameSpace">

	<resultMap id="usersMap" type="com.km.users.UsersVO">
		<id property="usercode" column="usercode" />
		<result property="email" column="email" />
		<result property="password" column="password" />
		<result property="f_name" column="f_name" />
		<result property="l_name" column="l_name" />
		<result property="sex" column="sex" />
		<result property="birth_y" column="birth_y" />
		<result property="birth_m" column="birth_m" />
		<result property="birth_d" column="birth_d" />
		<result property="nation" column="nation" />
		<result property="tel" column="tel" />
		<result property="user_pic_path" column="user_pic_path" />
		<result property="user_pic_oriname" column="user_pic_oriname" />
		<result property="user_pic_rename" column="user_pic_rename" />
		<result property="introduction" column="introduction" />
		<result property="confirm" column="confirm" />
		<result property="grade" column="grade" />
		<result property="user_regdate" column="user_regdate" />
		<result property="logdate" column="logdate" />
		<result property="user_drop" column="user_drop" />
		<result property="user_dropdate" column="user_dropdate" />
		<result property="regpath" column="regpath" />
	</resultMap>
	
	
	<resultMap id="identifyMap" type="com.km.users.IdentifyVO">
		<id property="usercode" column="usercode" />
		<result property="id_pic_path" column="id_pic_path" />
		<result property="id_pic_oriname" column="id_pic_oriname" />
		<result property="id_pic_rename" column="id_pic_rename" />
	</resultMap>
	
	
	<resultMap id="cardMap" type="com.km.users.CardVO">
	<id property="usercode" column="usercode" />
		<result property="cardname" column="cardname" />
		<result property="cardowner" column="cardowner" />
		<result property="cardnum" column="cardnum" />
		<result property="expire_date" column="expire_date" />
		<result property="cvc_code" column="cvc_code" />
	</resultMap>
	
	<sql id="commonSelect">usercode ,email ,password ,f_name , l_name ,sex ,birth_y ,birth_m ,birth_d ,nation ,tel  ,user_pic_path ,user_pic_oriname ,user_pic_rename,introduction ,confirm ,grade ,user_regdate ,logdate ,user_drop ,user_dropdate ,regpath </sql>
	
	
	<select id="login" parameterType="com.km.users.UsersVO" resultMap="usersMap">
		select usercode, confirm, grade, f_name, l_name, user_pic_path, user_pic_oriname, user_pic_rename 
		from users
		where email = #{email}
		and password =  #{password}
	</select>
	
	<update id="logdate" parameterType="String">
	 update users set logdate = sysdate
	 where email = #{value}
	</update>
	
	<insert id="register" parameterType="com.km.users.UsersVO">
	insert into users  
	(usercode ,email ,password ,f_name , l_name ,sex ,birth_y ,birth_m ,birth_d ,
	nation ,tel , user_pic_path ,user_pic_oriname ,user_pic_rename ,introduction, 
	confirm ,grade ,user_regdate ,logdate ,user_drop ,user_dropdate ,regpath) 
	values (#{usercode}, #{email}, #{password},	#{f_name}, #{l_name}, #{sex},
		#{birth_y},	#{birth_m},	#{birth_d},	#{nation},	#{tel},	#{user_pic_path},	
		#{user_pic_oriname}, #{user_pic_rename},#{introduction}, 'n', 'g',	sysdate,	
		null,	'n',	null,	'k')  
	</insert>
	

</mapper>